<div #bookingFormContainer
    class="bg-primary-900/15 border border-primary-500/10 rounded-3xl p-8 md:p-10 backdrop-blur-sm relative overflow-hidden transition-all duration-300">

    <!-- Success Overlay -->
    <div *ngIf="showSuccess"
        class="absolute inset-0 bg-primary-900/95 flex flex-col items-center justify-center z-20 animate-fade-in text-center p-6">
        <div class="w-20 h-20 bg-green-500/20 rounded-full flex items-center justify-center mb-6">
            <i class="pi pi-check-circle text-4xl text-green-400"></i>
        </div>
        <h3 class="text-2xl font-bold text-white mb-2">{{ 'booking_success_title' | translate }}</h3>
        <p class="text-text-secondary">{{ 'booking_success_message' | translate }}</p>
    </div>

    <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()">
        <h3 class="text-2xl font-bold text-white mb-8 text-center md:text-left">
            {{ 'booking_form_title' | translate }}
        </h3>

        <div class="space-y-6">
            <!-- Locations Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Pickup -->
                <div class="relative group">
                    <input type="text" id="pickup" formControlName="pickupLocation" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                               focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                               transition-all duration-300 placeholder-transparent"
                        [class.border-red-500]="f.pickupLocation.invalid && f.pickupLocation.touched"
                        placeholder="Pickup">
                    <label for="pickup"
                        class="absolute left-4 -top-2.5 bg-[#0f172a] px-1 text-sm text-primary-300 transition-all duration-300
                               peer-placeholder-shown:text-base peer-placeholder-shown:text-text-secondary peer-placeholder-shown:top-3.5 peer-placeholder-shown:bg-transparent
                               peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-primary-500 peer-focus:bg-[#0f172a]">
                        {{ 'booking_pickup' | translate }}
                    </label>
                    <i class="pi pi-map-marker absolute right-4 top-3.5 text-text-secondary"></i>
                </div>

                <!-- Dropoff -->
                <div class="relative group">
                    <input type="text" id="dropoff" formControlName="dropoffLocation" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                               focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                               transition-all duration-300 placeholder-transparent"
                        [class.border-red-500]="f.dropoffLocation.invalid && f.dropoffLocation.touched"
                        placeholder="Dropoff">
                    <label for="dropoff"
                        class="absolute left-4 -top-2.5 bg-[#0f172a] px-1 text-sm text-primary-300 transition-all duration-300
                               peer-placeholder-shown:text-base peer-placeholder-shown:text-text-secondary peer-placeholder-shown:top-3.5 peer-placeholder-shown:bg-transparent
                               peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-primary-500 peer-focus:bg-[#0f172a]">
                        {{ 'booking_dropoff' | translate }}
                    </label>
                    <i class="pi pi-flag absolute right-4 top-3.5 text-text-secondary"></i>
                </div>
            </div>

            <!-- Date & Time Grid -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Date -->
                <div class="relative group md:col-span-1">
                    <input type="date" id="date" formControlName="date" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                               focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                               transition-all duration-300 min-h-[50px]
                               [color-scheme:dark]" [class.border-red-500]="f.date.invalid && f.date.touched">
                    <p *ngIf="f.date.errors?.['pastDate']" class="absolute -bottom-5 left-0 text-xs text-red-400 pl-4">
                        {{ 'booking_date_error' | translate }}
                    </p>
                </div>

                <!-- Time -->
                <div class="relative group md:col-span-1">
                    <input type="time" id="time" formControlName="time" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                               focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                               transition-all duration-300 min-h-[50px]
                               [color-scheme:dark]">
                </div>

                <!-- Passengers -->
                <div class="relative group md:col-span-1">
                    <input type="number" id="passengers" formControlName="passengers" min="1" max="15" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                               focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                               transition-all duration-300 placeholder-transparent" placeholder="Pax">
                    <label for="passengers"
                        class="absolute left-4 -top-2.5 bg-[#0f172a] px-1 text-sm text-primary-300 transition-all duration-300
                               peer-placeholder-shown:text-base peer-placeholder-shown:text-text-secondary peer-placeholder-shown:top-3.5 peer-placeholder-shown:bg-transparent
                               peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-primary-500 peer-focus:bg-[#0f172a]">
                        {{ 'booking_passengers' | translate }}
                    </label>
                </div>
            </div>

            <!-- Vehicle Selection (Cards) -->
            <div>
                <label class="block text-sm font-medium text-text-secondary mb-3">{{ 'booking_vehicle_type' | translate }}</label>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <label *ngFor="let option of vehicleOptions" class="cursor-pointer relative group">
                        <input type="radio" formControlName="vehicleType" [value]="option.value" class="peer sr-only">
                        <div
                            class="p-4 rounded-xl border border-primary-500/20 bg-bg-secondary/30 transition-all duration-300
                                    peer-checked:bg-primary-900/50 peer-checked:border-primary-500 peer-checked:shadow-[0_0_15px_rgba(var(--color-primary-500),0.3)]
                                    hover:bg-primary-900/30 flex flex-col items-center justify-center gap-2 text-center h-full">
                            <i
                                [class]="option.icon + ' text-2xl mb-1 text-primary-400 group-hover:scale-110 transition-transform'"></i>
                            <span class="font-bold text-white text-sm">{{ option.label | translate }}</span>
                            <span class="text-xs text-text-secondary">{{ option.sublabel | translate }}</span>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Notes -->
            <div class="relative group">
                <textarea id="notes" formControlName="notes" rows="3" class="peer w-full px-4 py-3.5 bg-bg-secondary/50 border border-primary-500/20 rounded-xl text-white 
                           focus:outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-500
                           transition-all duration-300 placeholder-transparent resize-none"
                    placeholder="Notes"></textarea>
                <label for="notes" class="absolute left-4 -top-2.5 bg-[#0f172a] px-1 text-sm text-primary-300 transition-all duration-300
                           peer-placeholder-shown:text-base peer-placeholder-shown:text-text-secondary peer-placeholder-shown:top-3.5 peer-placeholder-shown:bg-transparent
                           peer-focus:-top-2.5 peer-focus:text-sm peer-focus:text-primary-500 peer-focus:bg-[#0f172a]">
                    {{ 'booking_notes' | translate }}
                </label>
            </div>

            <!-- Submit Button -->
            <button type="submit" [disabled]="isSubmitting"
                class="w-full py-4 bg-gradient-to-br from-[#2C5F8D] to-[#5BA3D0] text-white rounded-xl font-bold text-base shadow-lg 
                       transition-all duration-300 hover:shadow-glow-primary hover:scale-[1.02] active:scale-[0.98]
                       disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex justify-center items-center gap-2">
                <i *ngIf="isSubmitting" class="pi pi-spin pi-spinner"></i>
                <span *ngIf="!isSubmitting">{{ 'booking_submit' | translate }}</span>
                <span *ngIf="isSubmitting">{{ 'booking_processing' | translate }}</span>
            </button>
        </div>
    </form>
</div>